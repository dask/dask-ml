
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Preprocessing &#8212; dask-ml 2021.11.31 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/style.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cross Validation" href="cross_validation.html" />
    <link rel="prev" title="Dask-ML" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">

<nav class="dask-nav container-fluid">
  <ul>
    <li class="logo">
      <a href="https://docs.dask.org/">
        <img
          class="caption"
          src="_static/images/dask-horizontal-white.svg"
        />
      </a>
    </li>

    <li>
      <a href="https://docs.dask.org/">Dask</a>
    </li>

    <li>
      <a href="https://distributed.dask.org/">Distributed</a>
    </li>

    <li>
      <a href="https://ml.dask.org/">Dask ML</a>
    </li>

    <li>
      <a href="https://examples.dask.org/">Examples</a>
    </li>

    <li>
      <a href="https://docs.dask.org/en/latest/ecosystem.html">Ecosystem</a>
    </li>

    <li>
      <a href="https://docs.dask.org/en/latest/support.html">Community</a>
    </li>
  </ul>
</nav>


    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Use
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_validation.html">
   Cross Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hyper-parameter-search.html">
   Hyper Parameter Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="compose.html">
   Pipelines and Composite Estimators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glm.html">
   Generalized Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="naive-bayes.html">
   Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="meta-estimators.html">
   Parallel Meta-estimators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="incremental.html">
   Incremental Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clustering.html">
   Clustering
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="modules/api.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.train_test_split.html">
     dask_ml.model_selection.train_test_split
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.ShuffleSplit.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .ShuffleSplit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.KFold.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .KFold
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.GridSearchCV.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .GridSearchCV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.RandomizedSearchCV.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .RandomizedSearchCV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.IncrementalSearchCV.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .IncrementalSearchCV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.HyperbandSearchCV.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .HyperbandSearchCV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.SuccessiveHalvingSearchCV.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .SuccessiveHalvingSearchCV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.model_selection.InverseDecaySearchCV.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.model_selection
      </span>
     </code>
     .InverseDecaySearchCV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.ensemble.BlockwiseVotingClassifier.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.ensemble
      </span>
     </code>
     .BlockwiseVotingClassifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.ensemble.BlockwiseVotingRegressor.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.ensemble
      </span>
     </code>
     .BlockwiseVotingRegressor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.linear_model.LinearRegression.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.linear_model
      </span>
     </code>
     .LinearRegression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.linear_model.LogisticRegression.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.linear_model
      </span>
     </code>
     .LogisticRegression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.linear_model.PoissonRegression.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.linear_model
      </span>
     </code>
     .PoissonRegression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.naive_bayes.GaussianNB.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.naive_bayes
      </span>
     </code>
     .GaussianNB
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.wrappers.ParallelPostFit.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.wrappers
      </span>
     </code>
     .ParallelPostFit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.wrappers.Incremental.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.wrappers
      </span>
     </code>
     .Incremental
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.cluster.KMeans.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.cluster
      </span>
     </code>
     .KMeans
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.cluster.SpectralClustering.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.cluster
      </span>
     </code>
     .SpectralClustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.decomposition.IncrementalPCA.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.decomposition
      </span>
     </code>
     .IncrementalPCA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.decomposition.PCA.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.decomposition
      </span>
     </code>
     .PCA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.decomposition.TruncatedSVD.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.decomposition
      </span>
     </code>
     .TruncatedSVD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.StandardScaler.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .StandardScaler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.RobustScaler.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .RobustScaler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.MinMaxScaler.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .MinMaxScaler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.QuantileTransformer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .QuantileTransformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.Categorizer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .Categorizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.DummyEncoder.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .DummyEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.OrdinalEncoder.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .OrdinalEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.LabelEncoder.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .LabelEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.PolynomialFeatures.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .PolynomialFeatures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.preprocessing.BlockTransformer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.preprocessing
      </span>
     </code>
     .BlockTransformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.feature_extraction.text.CountVectorizer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.feature_extraction.text
      </span>
     </code>
     .CountVectorizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.feature_extraction.text.HashingVectorizer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.feature_extraction.text
      </span>
     </code>
     .HashingVectorizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.feature_extraction.text.FeatureHasher.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.feature_extraction.text
      </span>
     </code>
     .FeatureHasher
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.compose.ColumnTransformer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.compose
      </span>
     </code>
     .ColumnTransformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.compose.make_column_transformer.html">
     dask_ml.compose.make_column_transformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.impute.SimpleImputer.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.impute
      </span>
     </code>
     .SimpleImputer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.mean_absolute_error.html">
     dask_ml.metrics.mean_absolute_error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.mean_absolute_percentage_error.html">
     dask_ml.metrics.mean_absolute_percentage_error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.mean_squared_error.html">
     dask_ml.metrics.mean_squared_error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.mean_squared_log_error.html">
     dask_ml.metrics.mean_squared_log_error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.r2_score.html">
     dask_ml.metrics.r2_score
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.accuracy_score.html">
     dask_ml.metrics.accuracy_score
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.metrics.log_loss.html">
     dask_ml.metrics.log_loss
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.xgboost.XGBClassifier.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.xgboost
      </span>
     </code>
     .XGBClassifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.xgboost.XGBRegressor.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       dask_ml.xgboost
      </span>
     </code>
     .XGBRegressor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.xgboost.train.html">
     dask_ml.xgboost.train
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.xgboost.predict.html">
     dask_ml.xgboost.predict
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.datasets.make_counts.html">
     dask_ml.datasets.make_counts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.datasets.make_blobs.html">
     dask_ml.datasets.make_blobs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.datasets.make_regression.html">
     dask_ml.datasets.make_regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.datasets.make_classification.html">
     dask_ml.datasets.make_classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modules/generated/dask_ml.datasets.make_classification_df.html">
     dask_ml.datasets.make_classification_df
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Integration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="joblib.html">
   Scikit-Learn &amp; Joblib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="xgboost.html">
   XGBoost &amp; LightGBM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pytorch.html">
   PyTorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="keras.html">
   Keras and Tensorflow
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Develop
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Changelog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="roadmap.html">
   Dask-ML Roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="history.html">
   History
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/preprocessing.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn-clones">
   Scikit-Learn Clones
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#encoding-categorical-features">
   Encoding Categorical Features
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dask-ml-supports-pandas-categorical-dtype">
     Dask-ML Supports pandas’ Categorical dtype
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dask-ml-s-sparse-support">
     Dask-ML’s Sparse Support
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-tranformers">
   Additional Tranformers
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Preprocessing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn-clones">
   Scikit-Learn Clones
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#encoding-categorical-features">
   Encoding Categorical Features
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dask-ml-supports-pandas-categorical-dtype">
     Dask-ML Supports pandas’ Categorical dtype
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dask-ml-s-sparse-support">
     Dask-ML’s Sparse Support
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-tranformers">
   Additional Tranformers
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="preprocessing">
<h1>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="modules/api.html#module-dask_ml.preprocessing" title="dask_ml.preprocessing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dask_ml.preprocessing</span></code></a> contains some scikit-learn style transformers that
can be used in <code class="docutils literal notranslate"><span class="pre">Pipelines</span></code> to perform various data transformations as part
of the model fitting process. These transformers will work well on dask
collections (<code class="docutils literal notranslate"><span class="pre">dask.array</span></code>, <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code>), NumPy arrays, or pandas
dataframes. They’ll fit and transform in parallel.</p>
<div class="section" id="scikit-learn-clones">
<h2>Scikit-Learn Clones<a class="headerlink" href="#scikit-learn-clones" title="Permalink to this headline">¶</a></h2>
<p>Some of the transformers are (mostly) drop-in replacements for their
scikit-learn counterparts.</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.MinMaxScaler.html#dask_ml.preprocessing.MinMaxScaler" title="dask_ml.preprocessing.MinMaxScaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MinMaxScaler</span></code></a>([feature_range, copy, clip])</p></td>
<td><p>Transform features by scaling each feature to a given range.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.QuantileTransformer.html#dask_ml.preprocessing.QuantileTransformer" title="dask_ml.preprocessing.QuantileTransformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuantileTransformer</span></code></a>(*[, n_quantiles, ...])</p></td>
<td><p>Transforms features using quantile information.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.RobustScaler.html#dask_ml.preprocessing.RobustScaler" title="dask_ml.preprocessing.RobustScaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RobustScaler</span></code></a>(*[, with_centering, ...])</p></td>
<td><p>Scale features using statistics that are robust to outliers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.StandardScaler.html#dask_ml.preprocessing.StandardScaler" title="dask_ml.preprocessing.StandardScaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StandardScaler</span></code></a>(*[, copy, with_mean, with_std])</p></td>
<td><p>Standardize features by removing the mean and scaling to unit variance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.LabelEncoder.html#dask_ml.preprocessing.LabelEncoder" title="dask_ml.preprocessing.LabelEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LabelEncoder</span></code></a>([use_categorical])</p></td>
<td><p>Encode labels with value between 0 and n_classes-1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">OneHotEncoder</span></code>(n_values, ...)</p></td>
<td><p>Encode categorical integer features as a one-hot numeric array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.PolynomialFeatures.html#dask_ml.preprocessing.PolynomialFeatures" title="dask_ml.preprocessing.PolynomialFeatures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code></a>([degree, ...])</p></td>
<td><p>Generate polynomial and interaction features.</p></td>
</tr>
</tbody>
</table>
<p>These can be used just like the scikit-learn versions, except that:</p>
<ol class="arabic simple">
<li><p>They operate on dask collections in parallel</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.transform</span></code> will return a <code class="docutils literal notranslate"><span class="pre">dask.array</span></code> or <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code>
when the input is a dask collection</p></li>
</ol>
<p>See <a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing" title="(in scikit-learn v1.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sklearn.preprocessing</span></code></a> for more information about any particular
transformer. Scikit-learn does have some transforms that are alternatives to
the large-memory tasks that Dask serves. These include <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.FeatureHasher.html">FeatureHasher</a> (a
good alternative to <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.DictVectorizer.html">DictVectorizer</a> and <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">CountVectorizer</a>) and <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.HashingVectorizer.html">HashingVectorizer</a>
(best suited for use in text over <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">CountVectorizer</a>). They are not
stateful, which allows easy use with Dask with <code class="docutils literal notranslate"><span class="pre">map_partitions</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">dask.bag</span> <span class="k">as</span> <span class="nn">db</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="kn">import</span> <span class="n">FeatureHasher</span>

<span class="gp">In [3]: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;elephant&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}]</span>

<span class="gp">In [4]: </span><span class="n">b</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">from_sequence</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">h</span> <span class="o">=</span> <span class="n">FeatureHasher</span><span class="p">()</span>

<span class="gp">In [6]: </span><span class="n">b</span><span class="o">.</span><span class="n">map_partitions</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">[&lt;1x1048576 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;</span>
<span class="go"> 	with 3 stored elements in Compressed Sparse Row format&gt;,</span>
<span class="go"> &lt;1x1048576 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;</span>
<span class="go"> 	with 2 stored elements in Compressed Sparse Row format&gt;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.LabelEncoder.html#dask_ml.preprocessing.LabelEncoder" title="dask_ml.preprocessing.LabelEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.LabelEncoder</span></code></a> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.OneHotEncoder</span></code>
will use the categorical dtype information for a dask or pandas Series with
a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.api.types.CategoricalDtype</span></code>.
This improves performance, but may lead to different encodings depending on the
categories. See the class docstrings for more.</p>
</div>
</div>
<div class="section" id="encoding-categorical-features">
<h2>Encoding Categorical Features<a class="headerlink" href="#encoding-categorical-features" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.OneHotEncoder</span></code> can be useful for “one-hot” (or
“dummy”) encoding features.</p>
<p>See <a class="reference external" href="http://scikit-learn.org/dev/modules/preprocessing.html#preprocessing-categorical-features">the scikit-learn documentation</a>
for a full discussion. This section focuses only on the differences from
scikit-learn.</p>
<div class="section" id="dask-ml-supports-pandas-categorical-dtype">
<h3>Dask-ML Supports pandas’ Categorical dtype<a class="headerlink" href="#dask-ml-supports-pandas-categorical-dtype" title="Permalink to this headline">¶</a></h3>
<p>Dask-ML supports and uses the type information from pandas Categorical dtype.
See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/categorical.html">https://pandas.pydata.org/pandas-docs/stable/categorical.html</a> for an introduction.
For large datasets, using categorical dtypes is crucial for achieving performance.</p>
<p>This will have a couple effects on the learned attributes and transformed
values.</p>
<ol class="arabic simple">
<li><p>The learned <code class="docutils literal notranslate"><span class="pre">categories_</span></code> may differ. Scikit-Learn requires the categories
to be sorted. With a <code class="docutils literal notranslate"><span class="pre">CategoricalDtype</span></code> the categories do not need to be sorted.</p></li>
<li><p>The output of <code class="xref py py-meth docutils literal notranslate"><span class="pre">OneHotEncoder.transform()</span></code> will be the same type as the
input. Passing a pandas DataFrame returns a pandas Dataframe, instead of a
NumPy array. Likewise, a Dask DataFrame returns a Dask DataFrame.</p></li>
</ol>
</div>
<div class="section" id="dask-ml-s-sparse-support">
<h3>Dask-ML’s Sparse Support<a class="headerlink" href="#dask-ml-s-sparse-support" title="Permalink to this headline">¶</a></h3>
<p>The default behavior of OneHotEncoder is to return a sparse array. Scikit-Learn
returns a SciPy sparse matrix for ndarrays passed to <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p>
<p>When passed a Dask Array, <code class="xref py py-meth docutils literal notranslate"><span class="pre">OneHotEncoder.transform()</span></code> returns a Dask Array
<em>where each block is a scipy sparse matrix</em>. SciPy sparse matrices don’t
support the same API as the NumPy ndarray, so most methods won’t work on the
result. Even basic things like <code class="docutils literal notranslate"><span class="pre">compute</span></code> will fail. To work around this,
we currently recommend converting the sparse matrices to dense.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask_ml.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">enc</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]]),</span> <span class="n">chunks</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
<p>Each block of <code class="docutils literal notranslate"><span class="pre">result</span></code> is a scipy sparse matrix</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="c1"># This would fail!</span>
<span class="c1"># result.compute()</span>
<span class="c1"># Convert to, say, pydata/sparse COO matrices instead</span>
<span class="kn">from</span> <span class="nn">sparse</span> <span class="kn">import</span> <span class="n">COO</span>

<span class="n">result</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">COO</span><span class="o">.</span><span class="n">from_scipy_sparse</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
<p>Dask-ML’s sparse support for sparse data is currently in flux. Reach out if you
have any issues.</p>
</div>
</div>
<div class="section" id="additional-tranformers">
<h2>Additional Tranformers<a class="headerlink" href="#additional-tranformers" title="Permalink to this headline">¶</a></h2>
<p>Other transformers are specific to dask-ml.</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.Categorizer.html#dask_ml.preprocessing.Categorizer" title="dask_ml.preprocessing.Categorizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Categorizer</span></code></a>([categories, columns])</p></td>
<td><p>Transform columns of a DataFrame to categorical dtype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.DummyEncoder.html#dask_ml.preprocessing.DummyEncoder" title="dask_ml.preprocessing.DummyEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DummyEncoder</span></code></a>([columns, drop_first])</p></td>
<td><p>Dummy (one-hot) encode categorical columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="modules/generated/dask_ml.preprocessing.OrdinalEncoder.html#dask_ml.preprocessing.OrdinalEncoder" title="dask_ml.preprocessing.OrdinalEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OrdinalEncoder</span></code></a>([columns])</p></td>
<td><p>Ordinal (integer) encode categorical columns.</p></td>
</tr>
</tbody>
</table>
<p>Both <a class="reference internal" href="modules/generated/dask_ml.preprocessing.Categorizer.html#dask_ml.preprocessing.Categorizer" title="dask_ml.preprocessing.Categorizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.Categorizer</span></code></a> and
<a class="reference internal" href="modules/generated/dask_ml.preprocessing.DummyEncoder.html#dask_ml.preprocessing.DummyEncoder" title="dask_ml.preprocessing.DummyEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.DummyEncoder</span></code></a> deal with converting non-numeric
data to numeric data. They are useful as a preprocessing step in a pipeline
where you start with heterogenous data (a mix of numeric and non-numeric), but
the estimator requires all numeric data.</p>
<p>In this toy example, we use a dataset with two columns. <code class="docutils literal notranslate"><span class="pre">'A'</span></code> is numeric and
<code class="docutils literal notranslate"><span class="pre">'B'</span></code> contains text data. We make a small pipeline to</p>
<ol class="arabic simple">
<li><p>Categorize the text data</p></li>
<li><p>Dummy encode the categorical data</p></li>
<li><p>Fit a linear regression</p></li>
</ol>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="kn">from</span> <span class="nn">dask_ml.preprocessing</span> <span class="kn">import</span> <span class="n">Categorizer</span><span class="p">,</span> <span class="n">DummyEncoder</span>

<span class="gp">In [8]: </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="gp">In [9]: </span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="gp">In [10]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [11]: </span><span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>

<span class="gp">In [12]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]})</span>

<span class="gp">In [13]: </span><span class="n">X</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
<span class="gp">   ....: </span>   <span class="n">Categorizer</span><span class="p">(),</span>
<span class="gp">   ....: </span>   <span class="n">DummyEncoder</span><span class="p">(),</span>
<span class="gp">   ....: </span>   <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [16]: </span><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">Pipeline(steps=[(&#39;categorizer&#39;, Categorizer()),</span>
<span class="go">                (&#39;dummyencoder&#39;, DummyEncoder()),</span>
<span class="go">                (&#39;logisticregression&#39;, LogisticRegression())])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Categorizer</span></code> will convert a subset of the columns in <code class="docutils literal notranslate"><span class="pre">X</span></code> to categorical
dtype (see <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/categorical.html">here</a>
for more about how pandas handles categorical data). By default, it converts all
the <code class="docutils literal notranslate"><span class="pre">object</span></code> dtype columns.</p>
<p><code class="docutils literal notranslate"><span class="pre">DummyEncoder</span></code> will dummy (or one-hot) encode the dataset. This replaces a
categorical column with multiple columns, where the values are either 0 or 1,
depending on whether the value in the original.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    c</span>
<span class="go">3    c</span>
<span class="go">Name: B, dtype: object</span>

<span class="gp">In [18]: </span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gh">Out[18]: </span><span class="go"></span>
<span class="go">   a  b  c</span>
<span class="go">0  1  0  0</span>
<span class="go">1  0  1  0</span>
<span class="go">2  0  0  1</span>
<span class="go">3  0  0  1</span>
</pre></div>
</div>
<p>Wherever the original was <code class="docutils literal notranslate"><span class="pre">'a'</span></code>, the transformed now has a <code class="docutils literal notranslate"><span class="pre">1</span></code> in the <code class="docutils literal notranslate"><span class="pre">a</span></code>
column and a <code class="docutils literal notranslate"><span class="pre">0</span></code> everywhere else.</p>
<p>Why was the <code class="docutils literal notranslate"><span class="pre">Categorizer</span></code> step necessary? Why couldn’t we operate directly
on the <code class="docutils literal notranslate"><span class="pre">object</span></code> (string) dtype column? Doing this would be fragile,
especially when using <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code>, since <em>the shape of the output would
depend on the values present</em>. For example, suppose that we just saw the first
two rows in the training, and the last two rows in the tests datasets. Then,
when training, our transformed columns would be:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gh">Out[19]: </span><span class="go"></span>
<span class="go">   a  b</span>
<span class="go">0  1  0</span>
<span class="go">1  0  1</span>
</pre></div>
</div>
<p>while on the test dataset, they would be:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">   c</span>
<span class="go">2  1</span>
<span class="go">3  1</span>
</pre></div>
</div>
<p>Which is incorrect! The columns don’t match.</p>
<p>When we categorize the data, we can be confident that all the possible values
have been specified, so the output shape no longer depends on the values in the
whatever subset of the data we currently see. Instead, it depends on the
<code class="docutils literal notranslate"><span class="pre">categories</span></code>, which are identical in all the subsets.</p>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Dask-ML</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="cross_validation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cross Validation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dask developers<br/>
    
        &copy; Copyright 2017, Dask developers.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>