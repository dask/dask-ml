

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Preprocessing &mdash; dask-ml 1.1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="_static/js/custom.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/style.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/explore.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/nbsphinx.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cross Validation" href="cross_validation.html" />
    <link rel="prev" title="Examples" href="examples.html" />
  <link rel="shortcut icon" href="_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

  

<nav id="explore-links">
  <a href="https://docs.dask.org/">
    <img class="caption" src="_static/images/dask-horizontal-white.svg"/>
  </a>

  <ul>
    <li>
      <a>Get Started</a>
      <ul>
        <li><a href="https://docs.dask.org/en/latest/install.html"> Install </a></li>
        <li><a href="https://examples.dask.org"> Examples </a></li>
        <li><a href="https://github.com/dask/dask-tutorial"> Tutorial </a></li>
        <li><a href="https://docs.dask.org/en/latest/why.html"> Why Dask? </a></li>
        <li><a href="https://stories.dask.org/en/latest"> Use Cases </a></li>
        <li><a href="https://www.youtube.com/watch?v=RA_2qdipVng&list=PLRtz5iA93T4PQvWuoMnIyEIz1fXiJ5Pri"> Talks </a></li>
        <li><a href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab"> Try Online </a></li>
        <li><a href="https://dask.org/slides"> Slides </a></li>
      </ul>
    </li>

    <li>
      <a href="">Algorithms</a>
      <ul>
        <li><a href="https://docs.dask.org/en/latest/array.html">Arrays</a></li>
        <li><a href="https://docs.dask.org/en/latest/dataframe.html">Dataframes</a></li>
        <li><a href="https://docs.dask.org/en/latest/bag.html">Bags</a></li>
        <li><a href="https://docs.dask.org/en/latest/delayed.html">Delayed (custom)</a></li>
        <li><a href="https://docs.dask.org/en/latest/futures.html">Futures (real-time)</a></li>
        <li><a href="http://ml.dask.org">Machine Learning</a></li>
        <li><a href="https://xarray.pydata.org/en/latest/">XArray</a></li>
      </ul>
    </li>

    <li>
      <a href="https://docs.dask.org/en/latest/setup.html">Setup</a>
      <ul>
        <li><a href="https://docs.dask.org/en/latest/setup/single-machine.html"> Local </a></li>
        <li><a href="https://docs.dask.org/en/latest/setup/cloud.html"> Cloud </a></li>
        <li><a href="https://docs.dask.org/en/latest/setup/hpc.html"> HPC </a></li>
        <li><a href="https://kubernetes.dask.org/en/latest/"> Kubernetes </a></li>
        <li><a href="https://yarn.dask.org/en/latest/"> Hadoop / Yarn </a></li>
      </ul>
    </li>

    <li>
      <a>Community</a>
      <ul>
        <li><a href="http://docs.dask.org/en/latest/support.html">Ask for Help</a></li>
        <li><a href="https://github.com/dask">Github</a></li>
        <li><a href="https://stackoverflow.com/questions/tagged/dask">Stack Overflow</a></li>
        <li><a href="https://twitter.com/dask_dev">Twitter</a></li>
        <li><a href="https://blog.dask.org/"> Developer Blog </a></li>
      </ul>
    </li>
  </ul>

</nav>


  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> dask-ml
          

          
          </a>

          
            
            
              <div class="version">
                1.1.2.dev8+gfaaeff0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Use</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Preprocessing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#scikit-learn-clones">Scikit-Learn Clones</a></li>
<li class="toctree-l2"><a class="reference internal" href="#encoding-categorical-features">Encoding Categorical Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dask-ml-supports-pandas-categorical-dtype">Dask-ML Supports pandas’ Categorical dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dask-ml-s-sparse-support">Dask-ML’s Sparse Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#additional-tranformers">Additional Tranformers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cross_validation.html">Cross Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyper-parameter-search.html">Hyper Parameter Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="compose.html">Pipelines and Composite Estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="glm.html">Generalized Linear Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="joblib.html">Joblib</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta-estimators.html">Parallel Meta-estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="incremental.html">Incremental Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="xgboost.html">XGBoost</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensorflow.html">Tensorflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/api.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Develop</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Dask-ML Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dask-ml</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Preprocessing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/preprocessing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="preprocessing">
<h1>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="modules/api.html#module-dask_ml.preprocessing" title="dask_ml.preprocessing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dask_ml.preprocessing</span></code></a> contains some scikit-learn style transformers that
can be used in <code class="docutils literal notranslate"><span class="pre">Pipelines</span></code> to perform various data transformations as part
of the model fitting process. These transformers will work well on dask
collections (<code class="docutils literal notranslate"><span class="pre">dask.array</span></code>, <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code>), NumPy arrays, or pandas
dataframes. They’ll fit and transform in parallel.</p>
<div class="section" id="scikit-learn-clones">
<h2>Scikit-Learn Clones<a class="headerlink" href="#scikit-learn-clones" title="Permalink to this headline">¶</a></h2>
<p>Some of the transformers are (mostly) drop-in replacements for their
scikit-learn counterparts.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.MinMaxScaler.html#dask_ml.preprocessing.MinMaxScaler" title="dask_ml.preprocessing.MinMaxScaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MinMaxScaler</span></code></a>([feature_range,&nbsp;copy])</td>
<td>Transforms features by scaling each feature to a given range.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.QuantileTransformer.html#dask_ml.preprocessing.QuantileTransformer" title="dask_ml.preprocessing.QuantileTransformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuantileTransformer</span></code></a>([n_quantiles,&nbsp;…])</td>
<td>Transforms features using quantile information.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.RobustScaler.html#dask_ml.preprocessing.RobustScaler" title="dask_ml.preprocessing.RobustScaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RobustScaler</span></code></a>([with_centering,&nbsp;with_scaling,&nbsp;…])</td>
<td>Scale features using statistics that are robust to outliers.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.StandardScaler.html#dask_ml.preprocessing.StandardScaler" title="dask_ml.preprocessing.StandardScaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StandardScaler</span></code></a>([copy,&nbsp;with_mean,&nbsp;with_std])</td>
<td>Standardize features by removing the mean and scaling to unit variance</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.LabelEncoder.html#dask_ml.preprocessing.LabelEncoder" title="dask_ml.preprocessing.LabelEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LabelEncoder</span></code></a>([use_categorical])</td>
<td>Encode labels with value between 0 and n_classes-1.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="modules/api.html#dask_ml.preprocessing.OneHotEncoder" title="dask_ml.preprocessing.OneHotEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OneHotEncoder</span></code></a>([n_values,&nbsp;…])</td>
<td>Encode categorical integer features as a one-hot numeric array.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.PolynomialFeatures.html#dask_ml.preprocessing.PolynomialFeatures" title="dask_ml.preprocessing.PolynomialFeatures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code></a>([degree,&nbsp;…])</td>
<td>Generate polynomial and interaction features.</td>
</tr>
</tbody>
</table>
<p>These can be used just like the scikit-learn versions, except that:</p>
<ol class="arabic simple">
<li>They operate on dask collections in parallel</li>
<li><code class="docutils literal notranslate"><span class="pre">.transform</span></code> will return a <code class="docutils literal notranslate"><span class="pre">dask.array</span></code> or <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code>
when the input is a dask collection</li>
</ol>
<p>See <a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing" title="(in scikit-learn v0.21.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sklearn.preprocessing</span></code></a> for more information about any particular
transformer. Scikit-learn does have some transforms that are alternatives to
the large-memory tasks that Dask serves. These include <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.FeatureHasher.html">FeatureHasher</a> (a
good alternative to <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.DictVectorizer.html">DictVectorizer</a> and <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">CountVectorizer</a>) and <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.HashingVectorizer.html">HashingVectorizer</a>
(best suited for use in text over <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">CountVectorizer</a>). They are not
stateful, which allows easy use with Dask with <code class="docutils literal notranslate"><span class="pre">map_partitions</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">dask.bag</span> <span class="k">as</span> <span class="nn">db</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="kn">import</span> <span class="n">FeatureHasher</span>

<span class="gp">In [3]: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;elephant&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}]</span>

<span class="gp">In [4]: </span><span class="n">b</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">from_sequence</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">h</span> <span class="o">=</span> <span class="n">FeatureHasher</span><span class="p">()</span>

<span class="gp">In [6]: </span><span class="n">b</span><span class="o">.</span><span class="n">map_partitions</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">[&lt;1x1048576 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;</span>
<span class="go"> 	with 3 stored elements in Compressed Sparse Row format&gt;,</span>
<span class="go"> &lt;1x1048576 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;</span>
<span class="go"> 	with 2 stored elements in Compressed Sparse Row format&gt;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="modules/generated/dask_ml.preprocessing.LabelEncoder.html#dask_ml.preprocessing.LabelEncoder" title="dask_ml.preprocessing.LabelEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.LabelEncoder</span></code></a> and
<a class="reference internal" href="modules/api.html#dask_ml.preprocessing.OneHotEncoder" title="dask_ml.preprocessing.OneHotEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.OneHotEncoder</span></code></a>
will use the categorical dtype information for a dask or pandas Series with
a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.api.types.CategoricalDtype</span></code>.
This improves performance, but may lead to different encodings depending on the
categories. See the class docstrings for more.</p>
</div>
</div>
<div class="section" id="encoding-categorical-features">
<h2>Encoding Categorical Features<a class="headerlink" href="#encoding-categorical-features" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="modules/api.html#dask_ml.preprocessing.OneHotEncoder" title="dask_ml.preprocessing.OneHotEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.OneHotEncoder</span></code></a> can be useful for “one-hot” (or
“dummy”) encoding features.</p>
<p>See <a class="reference external" href="http://scikit-learn.org/dev/modules/preprocessing.html#preprocessing-categorical-features">the scikit-learn documentation</a>
for a full discussion. This section focuses only on the differences from
scikit-learn.</p>
<div class="section" id="dask-ml-supports-pandas-categorical-dtype">
<h3>Dask-ML Supports pandas’ Categorical dtype<a class="headerlink" href="#dask-ml-supports-pandas-categorical-dtype" title="Permalink to this headline">¶</a></h3>
<p>Dask-ML supports and uses the type information from pandas Categorical dtype.
See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/categorical.html">https://pandas.pydata.org/pandas-docs/stable/categorical.html</a> for an introduction.
For large datasets, using categorical dtypes is crucial for achieving performance.</p>
<p>This will have a couple effects on the learned attributes and transformed
values.</p>
<ol class="arabic simple">
<li>The learned <code class="docutils literal notranslate"><span class="pre">categories_</span></code> may differ. Scikit-Learn requires the categories
to be sorted. With a <code class="docutils literal notranslate"><span class="pre">CategoricalDtype</span></code> the categories do not need to be sorted.</li>
<li>The output of <a class="reference internal" href="modules/api.html#dask_ml.preprocessing.OneHotEncoder.transform" title="dask_ml.preprocessing.OneHotEncoder.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OneHotEncoder.transform()</span></code></a> will be the same type as the
input. Passing a pandas DataFrame returns a pandas Dataframe, instead of a
NumPy array. Likewise, a Dask DataFrame returns a Dask DataFrame.</li>
</ol>
</div>
<div class="section" id="dask-ml-s-sparse-support">
<h3>Dask-ML’s Sparse Support<a class="headerlink" href="#dask-ml-s-sparse-support" title="Permalink to this headline">¶</a></h3>
<p>The default behavior of OneHotEncoder is to return a sparse array. Scikit-Learn
returns a SciPy sparse matrix for ndarrays passed to <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p>
<p>When passed a Dask Array, <a class="reference internal" href="modules/api.html#dask_ml.preprocessing.OneHotEncoder.transform" title="dask_ml.preprocessing.OneHotEncoder.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OneHotEncoder.transform()</span></code></a> returns a Dask Array
<em>where each block is a scipy sparse matrix</em>. SciPy sparse matricies don’t
support the same API as the NumPy ndarray, so most methods won’t work on the
result. Even basic things like <code class="docutils literal notranslate"><span class="pre">compute</span></code> will fail. To work around this,
we currently recommend converting the sparse matricies to dense.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask_ml.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">enc</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]]),</span> <span class="n">chunks</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
<p>Each block of <code class="docutils literal notranslate"><span class="pre">result</span></code> is a scipy sparse matrix</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="c1"># This would fail!</span>
<span class="c1"># result.compute()</span>
<span class="c1"># Convert to, say, pydata/sparse COO matricies instead</span>
<span class="kn">from</span> <span class="nn">sparse</span> <span class="kn">import</span> <span class="n">COO</span>

<span class="n">result</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">COO</span><span class="o">.</span><span class="n">from_scipy_sparse</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
<p>Dask-ML’s sparse support for sparse data is currently in flux. Reach out if you
have any issues.</p>
</div>
</div>
<div class="section" id="additional-tranformers">
<h2>Additional Tranformers<a class="headerlink" href="#additional-tranformers" title="Permalink to this headline">¶</a></h2>
<p>Other transformers are specific to dask-ml.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.Categorizer.html#dask_ml.preprocessing.Categorizer" title="dask_ml.preprocessing.Categorizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Categorizer</span></code></a>([categories,&nbsp;columns])</td>
<td>Transform columns of a DataFrame to categorical dtype.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.DummyEncoder.html#dask_ml.preprocessing.DummyEncoder" title="dask_ml.preprocessing.DummyEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DummyEncoder</span></code></a>([columns,&nbsp;drop_first])</td>
<td>Dummy (one-hot) encode categorical columns.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="modules/generated/dask_ml.preprocessing.OrdinalEncoder.html#dask_ml.preprocessing.OrdinalEncoder" title="dask_ml.preprocessing.OrdinalEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OrdinalEncoder</span></code></a>([columns])</td>
<td>Ordinal (integer) encode categorical columns.</td>
</tr>
</tbody>
</table>
<p>Both <a class="reference internal" href="modules/generated/dask_ml.preprocessing.Categorizer.html#dask_ml.preprocessing.Categorizer" title="dask_ml.preprocessing.Categorizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.Categorizer</span></code></a> and
<a class="reference internal" href="modules/generated/dask_ml.preprocessing.DummyEncoder.html#dask_ml.preprocessing.DummyEncoder" title="dask_ml.preprocessing.DummyEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">dask_ml.preprocessing.DummyEncoder</span></code></a> deal with converting non-numeric
data to numeric data. They are useful as a preprocessing step in a pipeline
where you start with heterogenous data (a mix of numeric and non-numeric), but
the estimator requires all numeric data.</p>
<p>In this toy example, we use a dataset with two columns. <code class="docutils literal notranslate"><span class="pre">'A'</span></code> is numeric and
<code class="docutils literal notranslate"><span class="pre">'B'</span></code> contains text data. We make a small pipeline to</p>
<ol class="arabic simple">
<li>Categorize the text data</li>
<li>Dummy encode the categorical data</li>
<li>Fit a linear regression</li>
</ol>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="kn">from</span> <span class="nn">dask_ml.preprocessing</span> <span class="kn">import</span> <span class="n">Categorizer</span><span class="p">,</span> <span class="n">DummyEncoder</span>

<span class="gp">In [8]: </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="gp">In [9]: </span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="gp">In [10]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [11]: </span><span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>

<span class="gp">In [12]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]})</span>

<span class="gp">In [13]: </span><span class="n">X</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
<span class="gp">   ....: </span>   <span class="n">Categorizer</span><span class="p">(),</span>
<span class="gp">   ....: </span>   <span class="n">DummyEncoder</span><span class="p">(),</span>
<span class="gp">   ....: </span>   <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [16]: </span><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">Pipeline(memory=None,</span>
<span class="go">         steps=[(&#39;categorizer&#39;, Categorizer(categories=None, columns=None)),</span>
<span class="go">                (&#39;dummyencoder&#39;, DummyEncoder(columns=None, drop_first=False)),</span>
<span class="go">                (&#39;logisticregression&#39;,</span>
<span class="go">                 LogisticRegression(C=1.0, class_weight=None, dual=False,</span>
<span class="go">                                    fit_intercept=True, intercept_scaling=1,</span>
<span class="go">                                    l1_ratio=None, max_iter=100,</span>
<span class="go">                                    multi_class=&#39;warn&#39;, n_jobs=None,</span>
<span class="go">                                    penalty=&#39;l2&#39;, random_state=None,</span>
<span class="go">                                    solver=&#39;lbfgs&#39;, tol=0.0001, verbose=0,</span>
<span class="go">                                    warm_start=False))],</span>
<span class="go">         verbose=False)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Categorizer</span></code> will convert a subset of the columns in <code class="docutils literal notranslate"><span class="pre">X</span></code> to categorical
dtype (see <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/categorical.html">here</a>
for more about how pandas handles categorical data). By default, it converts all
the <code class="docutils literal notranslate"><span class="pre">object</span></code> dtype columns.</p>
<p><code class="docutils literal notranslate"><span class="pre">DummyEncoder</span></code> will dummy (or one-hot) encode the dataset. This replaces a
categorical column with multiple columns, where the values are either 0 or 1,
depending on whether the value in the original.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    c</span>
<span class="go">3    c</span>
<span class="go">Name: B, dtype: object</span>

<span class="gp">In [18]: </span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gh">Out[18]: </span><span class="go"></span>
<span class="go">   a  b  c</span>
<span class="go">0  1  0  0</span>
<span class="go">1  0  1  0</span>
<span class="go">2  0  0  1</span>
<span class="go">3  0  0  1</span>
</pre></div>
</div>
<p>Wherever the original was <code class="docutils literal notranslate"><span class="pre">'a'</span></code>, the transformed now has a <code class="docutils literal notranslate"><span class="pre">1</span></code> in the <code class="docutils literal notranslate"><span class="pre">a</span></code>
column and a <code class="docutils literal notranslate"><span class="pre">0</span></code> everywhere else.</p>
<p>Why was the <code class="docutils literal notranslate"><span class="pre">Categorizer</span></code> step necessary? Why couldn’t we operate directly
on the <code class="docutils literal notranslate"><span class="pre">object</span></code> (string) dtype column? Doing this would be fragile,
especially when using <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code>, since <em>the shape of the output would
depend on the values present</em>. For example, suppose that we just saw the first
two rows in the training, and the last two rows in the tests datasets. Then,
when training, our transformed columns would be:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gh">Out[19]: </span><span class="go"></span>
<span class="go">   a  b</span>
<span class="go">0  1  0</span>
<span class="go">1  0  1</span>
</pre></div>
</div>
<p>while on the test dataset, they would be:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">   c</span>
<span class="go">2  1</span>
<span class="go">3  1</span>
</pre></div>
</div>
<p>Which is incorrect! The columns don’t match.</p>
<p>When we categorize the data, we can be confident that all the possible values
have been specified, so the output shape no longer depends on the values in the
whatever subset of the data we currently see. Instead, it depends on the
<code class="docutils literal notranslate"><span class="pre">categories</span></code>, which are identical in all the subsets.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cross_validation.html" class="btn btn-neutral float-right" title="Cross Validation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Dask developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>